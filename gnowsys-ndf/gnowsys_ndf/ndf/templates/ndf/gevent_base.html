{% load simple_filters %}
{% xextends "ndf/gbase.html" with first_body_column=0 %}

{# {% extends "ndf/base.html" %} #}

{% load i18n %}
{% load cache %}
{% load ndf_tags %}
{% block title %}{% trans 'Events' %} {% endblock %}
{% block head %}
{{block.super}}
<script type="text/javascript" src="/static/ndf/bower_components/foundation/js/foundation.min.js"></script>
    <script type="text/javascript" src="/static/ndf/bower_components/foundation/js/foundation/foundation.topbar.js"></script>
  
{% endblock %}
{% block body_content %}
{% get_group_object groupid as group_object %}

{% get_breadcrumb request.path %}
    <div class="row group_content">
        <div class="small-12 columns">
            <div class="row">
                <div class="small-12 columns group_banner"></div>
            </div>
            <div class="row">
                <div class="small-12 columns group_header">
                    <div class="group_title left">{% firstof group_object.altnames group_object.name  %}</div>
                    <div class="right course_actions">

                        <span data-dropdown="course-settings-drop" aria-controls="course-settings-drop" aria-expanded="false" class="tiny radius right">
                            <i class="icon-widget fi-widget"></i>
                        </span>
                        <ul id="course-settings-drop" class="f-dropdown" data-dropdown-content aria-hidden="true" tabindex="-1">
                        <li>
                            <a href="{% url 'unit_edit' groupid group_object.pk %}" class="fi-pencil"> Edit</a>
                        </li>
                        <li>
                            <a data-reveal-id="manage_users_modal" href="{% url 'manage_users' group_id %}"  class="fi-torsos"> Manage Users</a> 
                            <div id="manage_users_modal" class="reveal-modal large" data-reveal style="position:absolute;"> 
                                <div id="group_drawer">
                                {% include "ndf/widget_user_search.html" with subscription_status=True %}
                                </div>
                                <a class="close-reveal-modal">&#215;</a>
                            </div>          
                        </li>
                        <li>
                            <a href="{% url 'create_event_group' group_id 'CourseEventGroup' %}?cnode_id={{group_id}}" class="fi-volume"> Announce</a>
                        </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="small-12 columns group_sections">
                    <ul class="horizontal_tabs_gstudio">
                        <li>
                            <a href="{% url 'course_about' group_id %}" {% if title == 'about' %}class="selected"{% endif %}>Overview</a>
                        </li>
                        <li >
                            <a href="{% url 'unit_detail' group_id %}" {% if title == 'unit_authoring' %}class="selected"{% endif %}>Lessons</a>
                            <!-- <a href="#group_blog">Blog</a> -->
                        </li>
                       <li>
                            <a href="{% url 'course_pages' group_id %}" {% if title == 'course_pages' %}class="selected"{% endif %}>Activity-Sheets</a>
                        </li>
                        <li>
                            <a href="{% url 'asset_list' group_id %}" {% if title == 'asset_list' or title == 'asset_detail' or title == 'asset_content_detail'%}class="selected"{% endif %}>Assets</a>
                        </li>
                        <li >
                            <a href="{% url 'course_notebook' group_id %}" {% if title == 'notebook' %}class="selected"{% endif %}>Notebook</a>
                            <!-- <a href="#group_blog">Blog</a> -->
                        </li>
<!--                         <li>
                            <a href="#group_overview" class="selected">Overview</a>
                        </li><li>
                            <a href="#group_pages">Pages</a>
                        </li><li>
                            <a href="#group_elibrary">eLibrary</a>
                        </li><li>
                            <a href="#group_forum">Forum</a>
                        </li><li>
                            <a href="#group_blog">Blog</a>
                        </li><li>
                            <a href="#group_calendar">Calendar</a>
                        </li><li>
                            <a href="#group_assessment">Assessment</a>
                        </li><li class="sub_group_action">
                            <a href="#"> &bull;&bull;&bull;</a>
                            <ul>
                                <li class="create_curriculum">
                                    <a href="./create-curriculum.html">Create curriculum</a>
                                </li>
                            </ul>
                        </li>
 -->                    </ul>
                </div>
            </div>
            <div class="row">
                <div class="small-12 columns group_sections_content">

                    <div id="group_overview">
                        {% if title == "about" %}
                            {% include "ndf/course_about.html" %}
                        {% endif %}
                    </div>
                    <div id="group_pages">
                        {% if title == "course_pages" %}
                            {% include "ndf/course_pages.html" %}
                        {% endif %}
                    </div>
                    <div id="group_elibrary">
                        {% if title == "asset_list" %}
                            {% include "ndf/assets.html" %}
                        {% endif %}
                        {% if title == "asset_detail" or title == "asset_content_detail" %}
                            {% include "ndf/add_asset.html" %}
                        {% endif %}
                    </div>
                    <div id="addAsset" class="reveal-modal reveal-modal-overlay" data-reveal aria-labelledby="modalTitle" aria-hidden="true" role="dialog">
                        <a class="close-reveal-modal" aria-label="Close">&#215;</a>
                    </div>
                    <div id="group_forum">

                    </div>
                    <div id="group_blog">
                        {% if title == 'notebook' %}
                            {% include "ndf/gnotebook.html" %}
                        {% endif %}
                    </div>
                    <div id="group_calendar">

                    </div>
                    <div id="group_assessment">
                    </div>
                    <div id="unit_authoring_div">
                        {% if title == 'unit_authoring' %}
                            {% include "ndf/unit_structure.html" %}
                        {% endif %}

                    </div>


                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        
        $(function(){
            /*Group sections tabs*/
            // $('.group_sections_content >div').hide();
            // $('.group_sections_content #group_elibrary').show();
            // $('.horizontal_tabs_gstudio').on('click', ' >li>a', function(e) {
            //     e.preventDefault();
            //     var id = $(this).attr('href');

            //     if (id !== '#') { // If the id is hash then we will not handle it.
            //         $('.group_sections .selected').removeClass('selected');
            //         $(this).addClass('selected');

            //         $('.group_sections_content >div').hide();
            //         $('.group_sections_content '+id).show();
            //     }
            // });

            // Create Curriculum

            $('.transcript_files, .subtitle_files').on('click', 'span', function(){
                var input = $(this).siblings('input');
                $(this).closest('div').prepend('<input type="file" name="'+input.attr('name')+'"/>');
            })
        });

        
            $( ".createAsset" ).click(function() {
                    var asset_id = $(this).attr('data-asset_id');
                    $.ajax({
                              type: "GET",
                              url: "{% url 'add_asset' group_id %}",
                              data: {
                                node_id: asset_id
                              },
                              datatype: "html",
                              success: function(data) {
                                $('#addAsset').foundation('reveal', 'open');
                                $('#addAsset').html(data);
                            }

                      });
            });

    </script>
    

{% endblock body_content %}
